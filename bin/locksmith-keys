#!/bin/bash

# purpose:  manage keys

enroll() {
    enrollKey "$@"
}

list() {
    showKeys "$KeysFile" "$@"
}

show() {
    list "$@"
}

expired() { 
    if [ "$#" -lt 1 ] ; then
	showKeys "$ExpiredKeysFile"
	return
    fi
}

expiredre() { 
    getExpiredKeysRegexp
}

expire() { 
    if [ "$#" -lt 1 ] ; then
	echo "You must specify a key to expire (perhaps you wanted 'expired'?)"
	return
    fi

    grep "$1" "$KeysFile" | while read key ; do
	echo -n  "Expiring " ; showKeys $key
	echo $key >> "$ExpiredKeysFile"
    done

    resortKeyfile "$ExpiredKeysFile"
}

source `dirname $0`/locksmith-common

mainloop list "$@"